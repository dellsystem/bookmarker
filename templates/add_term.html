{% extends "base.html" %}

{% block breadcrumbs %}
<a class="section" href="{% url 'view_book' book.pk %}">View book</a>
<i class="right angle icon divider"></i>
<div class="active section">Add term</div>
{% endblock %}

{% block content %}
{% include 'book_header.html' with book=book only %}

<div class="ui divider"></div>

{% with num_terms=book.terms.count %}
{% if num_terms %}
<h3>
    Recent terms ({{ num_terms }} total)
    ::
    <a href="{% url 'view_terms' book.pk %}">View all &raquo;</a>
</h3>
<div class="ui celled two column grid">
    <div class="column">
        {% include 'term_snippets.html' with terms=recent_terms_1 only %}
    </div>
    <div class="column">
        {% include 'term_snippets.html' with terms=recent_terms_2 only %}
    </div>
</div>
{% else %}
<div class="ui warning message">
    <div class="header">
        No terms yet!
    </div>
</div>
{% endif %}
{% endwith %}

<div class="ui segment">
    <form class="ui form" method="post">
        {% csrf_token %}
        <div class="ui fields">
            {% with error=form.term.errors %}
            <div class="eight wide {% if error %}error{% endif %} field">
                <label>Term{% if error %} (REQUIRED){% endif %}</label>
                {{ form.term }}
            </div>
            {% endwith %}
            {% with error=form.language.errors %}
            <div class="five wide {% if error %}error{% endif %} field">
                <label>Language{% if error %} (REQUIRED){% endif %}</label>
                {{ form.language }}
            </div>
            {% endwith %}
            <div class="three wide field">
                <label>&nbsp;</label>
                <button class="ui fluid blue icon button"
                        type="button"
                        onclick="fetchDefinition()">
                    <i class="translate icon"></i> Fetch definition
                </button>
            </div>
        </div>
        <div class="ui fields">
            <div class="four wide field">
                <label>Author</label>
                {{ form.author }}
            </div>
            {% with error=form.page.errors %}
            <div class="two wide {% if error %}error{% endif %} field">
                <label>Page{% if error %} (REQUIRED){% endif %}</label>
                {{ form.page }}
            </div>
            {% endwith %}
            <div class="seven wide field">
                <label>Section</label>
                {{ form.section }}
            </div>
            {% with error=form.category.errors %}
            <div class="two wide {% if error %}error{% endif %} field">
                <label>Category{% if error %} (REQUIRED){% endif %}</label>
                {{ form.category }}
            </div>
            {% endwith %}
            <div class="one wide field">
                <label>New?</label>
                {{ form.is_new }}
            </div>
            <div class="one wide field">
                <label>Defined?</label>
                {{ form.is_defined }}
            </div>
        </div>
        <div class="three fields">
            {% with error=form.definition.errors %}
            <div class="{% if error %}error{% endif %} field">
                <label>
                    Definition{% if error %} (REQUIRED){% endif %}
                    <a id="definition_edit" class="hidden">
                        <i class="edit icon"></i>
                    </a>
                </label>
                {{ form.definition }}
            </div>
            {% endwith %}
            <div class="field">
                <label>Quote</label>
                {{ form.quote }}
            </div>
            <div class="field">
                <label>Comments</label>
                {{ form.comments }}
            </div>
        </div>
        <div class="ui basic center aligned segment">
            <button type="submit" name="submit"
                    class="ui blue button">
                Submit
            </button>
        </div>
    </form>
</div>
{% endblock %}
